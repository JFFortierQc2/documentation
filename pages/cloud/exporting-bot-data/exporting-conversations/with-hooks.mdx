import { Callout } from 'nextra/components'

## Exporting Conversations from within your Bot with Hooks

In this tutorial we are going to set up Hooks for building the conversation history on the go, which you can send at any moment to an third-party service using their APIs or via Email.

## Setting up the Hooks

1. Create a hook under "Before Incoming Message" in the "Hooks" section with the following code:

```js
if (!event.state.session.fullHistory) {
  event.state.session.fullHistory = ''
}
event.state.session.fullHistory = event.state.session.fullHistory + `user :  ${event.payload.text}` + '\n'
```

2. Create a hook under "Before Outgoing Message" in the "Hooks" section with the following code:

```js
if (!event.state.session.fullHistory) {
  event.state.session.fullHistory = ''
}
event.state.session.fullHistory = event.state.session.fullHistory + `bot : ${outgoingEvent.payload.text}` + '\n'
```

3. Create an [Execute Code card](../toolbox/execute-code) manipulating the variable as you prefer, for example sending it to an API:

```js
await axios.post('https://my-api-url.com', {
	conversation: event.state.session.fullHistory
	user: user.name
})
```

<Callout type="info">
  You could add this card to the end of your bot's flow to get the full history or add it to the [Conversation
  End](../studio/workflows/#conversation-end) workflow so that it is automatically sent when the conversation ends.
</Callout>
